{
  "gitSyncId": "67a5c50a93de7f15bb3860ab_35e94a3d-6471-478a-a55e-3a0e7127607e",
  "id": "Inventory Alat_InventoryAlatTable1",
  "pluginId": "mysql-plugin",
  "pluginType": "DB",
  "unpublishedAction": {
    "actionConfiguration": {
      "body": "SELECT \n    ROW_NUMBER() OVER (ORDER BY inv.id ASC) AS no, \n    inv.id, \n    inv.item, \n    inv.price,\n    GREATEST(inv.stock - COALESCE(sewa.total_sku, 0), 0) AS stock, -- Sinkronisasi stok\n    inv.sku,\n    inv.merk\nFROM (\n    SELECT \n        wp_posts.ID AS id, \n        wp_posts.post_title AS item, \n        wp_postmeta_price.meta_value AS price,\n        CAST(wp_postmeta_stock.meta_value AS SIGNED) AS stock,\n        CONVERT(wp_postmeta_sku.meta_value USING utf8mb4) AS sku, -- Konversi collation\n        MAX(wp_terms.name) AS merk\n    FROM \n        wp_posts\n    LEFT JOIN \n        wp_postmeta AS wp_postmeta_price \n        ON wp_posts.ID = wp_postmeta_price.post_id AND wp_postmeta_price.meta_key = '_price'\n    LEFT JOIN \n        wp_postmeta AS wp_postmeta_stock \n        ON wp_posts.ID = wp_postmeta_stock.post_id AND wp_postmeta_stock.meta_key = '_stock'\n    LEFT JOIN \n        wp_postmeta AS wp_postmeta_sku \n        ON wp_posts.ID = wp_postmeta_sku.post_id AND wp_postmeta_sku.meta_key = '_sku'\n    INNER JOIN  \n        wp_term_relationships ON wp_posts.ID = wp_term_relationships.object_id\n    INNER JOIN  \n        wp_term_taxonomy ON wp_term_relationships.term_taxonomy_id = wp_term_taxonomy.term_taxonomy_id \n        AND wp_term_taxonomy.taxonomy = 'product_brand'\n    INNER JOIN  \n        wp_terms ON wp_term_taxonomy.term_id = wp_terms.term_id\n    WHERE \n        wp_posts.post_type IN ('product', 'product_variation')\n        AND wp_postmeta_sku.meta_value != ''\n    GROUP BY \n        wp_posts.ID, wp_posts.post_title, wp_postmeta_price.meta_value,\n        wp_postmeta_stock.meta_value, wp_postmeta_sku.meta_value\n) AS inv\nLEFT JOIN (\n    SELECT \n        CONVERT(rent_sku USING utf8mb4) AS sku, -- Konversi collation\n        COUNT(*) AS total_sku \n    FROM \n        wp_postrent_log \n    GROUP BY rent_sku\n) AS sewa ON inv.sku = sewa.sku\nORDER BY inv.id ASC;\n",
      "encodeParamsToggle": true,
      "paginationType": "NONE",
      "pluginSpecifiedTemplates": [
        {
          "value": true
        }
      ],
      "timeoutInMillisecond": 10000
    },
    "confirmBeforeExecute": false,
    "datasource": {
      "id": "Mitrakuli-Database",
      "isAutoGenerated": false,
      "name": "Mitrakuli-Database",
      "pluginId": "mysql-plugin"
    },
    "dynamicBindingPathList": [],
    "executeOnLoad": true,
    "name": "InventoryAlatTable1",
    "pageId": "Inventory Alat",
    "userSetOnLoad": false
  }
}